<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR App with Marker-Based and Markerless AR</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://cdn.rawgit.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script>
        function startMarkerlessAR() {
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(70, window.innerWidth / window.innerHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            // Adjust camera position
            camera.position.set(0, 0, 5);

            // Placeholder model
            const geometry = new THREE.BoxGeometry(0.1, 0.1, 0.1);
            const material = new THREE.MeshBasicMaterial({ color: 0x00ff00 });
            const cube = new THREE.Mesh(geometry, material);
            cube.position.set(0, 0, -2); // Move the cube closer to the camera
            scene.add(cube);

            // Render loop
            function render() {
                renderer.render(scene, camera);
            }
            renderer.setAnimationLoop(render);

            console.log('Markerless AR started');
        }


        function placeModel(position) {
            // Load the 3D model
            const loader = new THREE.GLTFLoader();
            loader.load(
                'models/your-model.glb', // Path to your model file
                function (gltf) {
                    // Once the model is loaded, position it at the specified location
                    const model = gltf.scene;
                    model.position.copy(position);
                    scene.add(model);
                },
                undefined,
                function (error) {
                    console.error('Error loading GLTF model:', error);
                }
            );
        }
        function onTouchStart(event) {
            const touch = event.touches[0];
            const raycaster = new THREE.Raycaster();
            const mouse = new THREE.Vector2(
                (touch.clientX / window.innerWidth) * 2 - 1,
                -(touch.clientY / window.innerHeight) * 2 + 1
            );
            raycaster.setFromCamera(mouse, camera);
            const intersects = raycaster.intersectObjects(scene.children, true);
            if (intersects.length > 0) {
                const intersection = intersects[0];
                const position = new THREE.Vector3().copy(intersection.point);
                placeModel(position);
            }
        }

        document.addEventListener('touchstart', onTouchStart, false);
    </script>
</head>
<body style="margin: 0; overflow: hidden;">
    <h1>AR App with Marker-Based and Markerless AR</h1>

    <!-- AR Scene -->
    <a-scene embedded arjs>
        <!-- Define Marker -->
        <a-marker preset="hiro">
            <!-- Place AR Content -->
            <a-entity gltf-model="#yourModel" scale="0.5 0.5 0.5"></a-entity>
        </a-marker>

        <!-- Camera -->
        <a-entity camera></a-entity>
    </a-scene>

    <!-- Model Asset -->
    <a-assets>
        <a-asset-item id="yourModel" src="models/your-model.glb"></a-asset-item>
    </a-assets>

    <!-- Touch Interaction -->
    <script>
        document.addEventListener('touchstart', onTouchStart, false);
    </script>
</body>
</html>
